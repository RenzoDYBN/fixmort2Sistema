<%- include("template/header") %>
<%- include("template/navbar") %>
<%- include("template/aside") %>


<div class="content-wrapper">
  <%- include('template/breadcrumb', {module: 'Crear CotizaciÃ³n'}) %>
  <section class="content-header">
    <div class="container-fluid">
      <div class="row mb-2">
        <div class="col-md-12">
          <div class="container">
            <form id="form" action="" method="POST">
              <!-- onsubmit="save_data()" -->
                    <div class="form-group">
                        <label>Servicios</label>
                        <select id="valores" class="select2" multiple="multiple" data-placeholder="Selecciona los servicios"
                                    style="width: 40%;">
                              <% results.forEach ((cotiz) => { %>
                                <option value="<%= cotiz.nombre_rol %>"><%= cotiz.nombre_rol %></option>        
                                <% }) %>
                            </select>
                      </div>
                    <div class="formulario__div-botones" style="text-align:center;">
                    <input type='hidden' id= 'hiddenField' name='id' value='' />
                    <input id="btnSubmit" type="submit" class="formulario__boton slide" value="Registrar" >
                    <!-- onclick="almacen();" -->
                </div>
            </form>
        </div>
    </div>

      </div><!-- /.container-fluid -->
    </section>

    <!-- /.content -->
  </div>
  <!-- /.content-wrapper -->
  
  <%- include("template/footer") %>
  <script>

        // const payMethSelect = document.querySelector('#valores');
    // console.log(payMethSelect);
// init
// let opts = (JSON.parse( localStorage.getItem('valores') || '[]' ))
// console.log(opts);
// Array.from( payMethSelect.options).forEach(opt => 
//   {
//   opt.selected = opts.includes(opt.value)
//   });

// payMethSelect.onchange =_=>
//   {
//   let opts = Array.from(payMethSelect.selectedOptions).map(opt=>opt.value)
//   console.log(opts);
//   localStorage.setItem('valores', JSON.stringify(opts))
//   }
//   console.log(opts);
//   console.log("enviado");
 
// function almacen() {
//     const items = { ...localStorage };

//   console.log(items);
// }
  

$(document).ready(function() {
$('#btnSubmit').click(function() {
            $.ajax({
                url: 'http://localhost:3000/saveCotizacion',
                type: 'post',
                dataType: 'json',
                data: {
                  valores: $('#valores').val()
                }
            })

});
});

function save_data() {

  var storedValue = localStorage.getItem("valores");
    console.log("llegue aqui a stored");
    console.log(storedValue);
}


// function ClientSide()
// {
//     var info = [];
//     info[0] = 'hi';
//     info[1] = 'hello';

//     var json = JSON.stringify(info); //pass this

//     $.ajax({
//         type: 'post',
//         url: '/save',
//         data: json,
//         contentType: "application/json; charset=utf-8",
//         dataType: "json",
//         success: function (html) {
//             // use data
//         }
//     })
// }



  </script>

